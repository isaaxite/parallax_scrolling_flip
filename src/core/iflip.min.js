'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};(function(){'function'!=typeof Object.assign&&Object.defineProperty(Object,'assign',{value:function(c){'use strict';if(null==c)throw new TypeError('Cannot convert undefined or null to object');for(var h,f=Object(c),g=1;g<arguments.length;g++)if(h=arguments[g],null!=h)for(var i in h)Object.prototype.hasOwnProperty.call(h,i)&&(f[i]=h[i]);return f},writable:!0,configurable:!0})})();function iTool(){return'object'===_typeof(iTool.instance)?iTool.instance:(this.createTime=new Date,iTool.instance=this,this)}Object.assign(iTool.prototype,{asyncRootPx:function asyncRootPx(){var a=document.querySelector('html');a.style.fontSize=a.offsetWidth/10+'px'},animate:function animate(a){var b=function(){var c=a&&a();c&&requestAnimationFrame(b)};requestAnimationFrame(b)},preLoadBgImage:function preLoadBgImage(a,b,c){var d=a.length,f=[];(function g(h){var i=new Image;i.src=a[h],i.onload=function(){f.push(i.src),b&&b(i.src,h),++h<d&&g(h),c&&c(f)}})(0)},forbidSpringback:function forbidSpringback(){document.body.addEventListener('touchstart',function(a){a.preventDefault()})},inheritPrototype:function(a,b){var c=Object.create(b.prototype);c.constructor=a,a.prototype=c}});function iGesture(a){iTool.call(this),this.currentPage=1,this.touchStartX=0,this.screenWidth=document.body.scrollWidth,this.mash=document.querySelector(a.mashEl),this.story=document.querySelector(a.storyEl),this.validFlipDistance=a.validFlipDistance||this.screenWidth/10,this.frameDistance=a.frameDistance||30,this.afterTouchstart=a.afterTouchstart,this.afterTouchend=a.afterTouchend,this.touchmoving=a.touchmoving,this.init()}inheritPrototype(iGesture,iTool),Object.assign(iGesture.prototype,{init:function init(){this.eventBind()},eventBind:function eventBind(){var a=this,b=a.mash;b&&b.addEventListener('touchstart',function(c){var d=c.changedTouches[0];a.touchStartX=d.pageX,a.afterTouchstart&&a.afterTouchstart(d)},!1),b&&b.addEventListener('touchmove',function(c){var d=a.story,f=a.touchStartX,g=c.changedTouches[0],h=g.pageX,i=-(h-f),j=(a.currentPage-1)*a.screenWidth;d.scrollLeft=j+i,a.touchmoving&&a.touchmoving(g,i)},!1),b&&b.addEventListener('touchend',function(c){var d=a.touchStartX,f=c.changedTouches[0],g=f.pageX,h=0>g-d,i=Math.abs(g-d)>=a.validFlipDistance,j=a.currentPage,k=a.story.children.length,l=1;i?(a.currentPage=h?a.currentPage+1:a.currentPage-1,a.currentPage=a.currentPage>k?k:a.currentPage,a.currentPage=a.currentPage<l?l:a.currentPage):h=!h;var m=(a.currentPage-1)*a.screenWidth,n=a.frameDistance;a.animate(function(){var o=a.story.scrollLeft;if(o=h?o+n:o-n,h&&o>m){var p=a.currentPage===k,q=j!=a.currentPage;return a.story.scrollLeft=m,a.afterTouchend&&a.afterTouchend(a.currentPage,p&&q),!1}if(!h&&o<m){var p=a.currentPage===k,q=j!=a.currentPage;return a.story.scrollLeft=m,a.afterTouchend&&a.afterTouchend(a.currentPage,p&&q),!1}return a.story.scrollLeft=o,!0})})}});function inheritPrototype(a,b){var c=Object.create(b.prototype);c.constructor=a,a.prototype=c}